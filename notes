watch HELM doc

SETUP.SH
check if minikube Docker and kubectl and installed and launched

NGINX
- ssl in nginx
- write html index and landing page
- write nginx.conf
- ingress
- find the way to expose my node/pod
- yaml Files
- return 80 to 443
- return 307 
- proxy
- reverse proxy
--------- info discord
1)la bonne ip nginx c'est la 172.20.0.6 pour y acceder depuis ton navigateur web de la vm
tente de clear le cache
2) pas de port 22, oubli de changement du sujet
3) Bonjour, je viens de commencer le sujet et il y a un élément que je ne comprend pas, il est écrit que "Wordpress needs its own nginx server" et même chose pour PMA, nous sommes donc d'accord pour dire qu'il faut un container [wordpress + nginx] , un autre [pma + nginx] et finalement un container avec uniquement nginx?
4) Salut salut, je me demandais si parmis vous quelquun avait reussi a gerer le reverse proxy vers PMA ? Je souhaite le faire via nginx mais jobtiens une page blanche malgre la presence du code source dans le browser, a noter que cela marche tres bien sans passer par le proxy. Je vous avoue que je commence a me dire que je vais choisir la facilite avec un bon vieux socat mais bon cest pas tres stable comme solution.
il faut rajouter cette config dans pma : $cfg['PmaAbsoluteUri'] = './';
et mettre cette location dans ton fichier de conf nginx : location /phpmyadmin/
(avec le /, je ne sais pas pourquoi mais il fait pas try_files $uri $uri/ dans
ce cas la)

WORDPRESS
- launch DB
- link with phpmyadmin

MYSQL

PHPMYADMIN

GRAFFANA
telegraph
1)apk add telegraf --repository http://dl-cdn.alpinelinux.org/alpine/edge/community/  ca ca marche
2)Salut ! J'essaye de me renseigner sur comment créer / modifier un fichier grafana.db, je ne trouve rien merci !
il se cree automatiquement quand tu commences a configurer des trucs sur le dashboard. l'emplacement exacte est dans le fichier de conf grafana.ini, il faut aller les recuperer dans un container du deploiement grafana

METALLB
1) Bonjour, quelqu'un à reussi a definir l'IP range de metallb via un script/fichier de config ? Ou l'operation sera forcément manuelle -> Elle necessite l'ip du cluster
	Perso j'utilise docker en vm-driver. Donc j'ai cree un network docker pour les ip externes :
docker network create my-net
docker network connect my-net minikube
Et ensuite, pour savoir quelles ip on peut donner a metallb :
docker network inspect my-network
Le champ IPAM.COnfig.Subnet donne le sous reseau.
Donc par exemple si IPAM.COnfig.Subnet = 172.18.0.0/16, je peux donner par  exemple un range de 172.18.0.10 - .0.20 a metallb.
Pour eviter la config manuelle de metallb, on peut faire: 
docker network create --subnet=172.20.0.0/16 my-net
docker network connect my-net minikube
Ps: le reseau doit etre cree sur le docker de l'host, donc eval $(minikube docker-env --unset)
Par contre si tu restart. Minikube est en pls car il a 2 networks. Il ne sait pas retrouver le sien...
https://github.com/kubernetes/minikube/issues/10079
Donc pour restart sans delete. Faut d'abord disconnect le network.
minikube stop
docker network disconnect my-net minikube
minikube start
docker network connect my-net minikube
Et aussi pour eviter les problemes de network deja existant en correction.
Au debut du script,  tu peux mettre un truc comme ca
set -euo pipefail # pour exit le script a la premiere erreur. (Important et tres utile)
# (man bash ou sh/dash sous alpine, section `SHELL BUILTIN COMMANDS`)
# et pour debug: rajouter l'option -x
eval $(minikube docker-env --unset)                        
minikube delete                                             
docker network prune --force    
Comme ca, pas de problemes si tu definis un --subnet lors de la creation du reseau. 
Si ca marche toujours pas.C'est que le correcteur a un container qui tourne avec un reseau ayant le meme subnet.
2) j'ai test de mettre la meme ip dans les .yaml mais ca passe pas, une option de metalLb que j'ai pas vu ?
les annotations dans chaque service, dans meta
  annotations:
    metallb.universe.tf/allow-shared-ip: "ft_services"`
moi j'ai pas mis d'adresse IP dans mes yaml, j'ai laisse metallb les attribuer. apres j'ai mis une range 192.168.0.1-192.168.0.1 (avec une IP adapter a minikube-ip) dans leyaml de configuration de metalllb

FTPS
1) Hello, sa fait 3-4 jours que je bloque sur le FTPS, tout semble fonctionner, quand je crée mon container et que je le lance il marche individuellement mais quand je le place dans k8s il ne veux pas fonctionner, j'ai toujours la même erreur, j'ai essayer de désactiver le mode passif, ouvrir les port du mode passif (que j'ai défini sur 21000 et 21001), est ce que quelqu'un a une idée ?
Pour ceux qui ont cette erreur a l'avenir, il faut juste set pasv_address avec l'adresse IP de minikube,  quel plaisir de trouver cette erreur x)
2) tu peux  utiliser adduser
mais il te demande d'entrer un mot de passe (+ confirmation)
du coup j'ai fait ca
{ echo "ftp_password"; echo "ftp_password"; } | adduser ftp_user
(et je l'ai mis en instruction RUN dans mon Dockerfile)
apres il faut une configuration minimale de ton fichier vsftpd.conf pour accepter les localuser, mais il me semble que c'est assez documente quand tu te renseignes sur vsftpd


INFLUXDB

endpoint :
The term has its origin in reference to computer networks. The endpoint is a device or node that is connected to the LAN or WAN and accepts communications back and forth across the network. In a traditional sense, an endpoint can be a modem, hub, bridge, or switch. It also could be data terminal equipment (such as a digital telephone handset, router, or printer) or a host computer (such as a workstation or a server).

question Maincourt :
- METALLB c'est un layer ?
- est-ce que ca veut dire quelquechose son propre nginx ? un nginx par service
  ou un seul au global ?


DOCKER:
docker build -f /path/to/a/Dockerfile .
docker build -t shykes/myapp .
docker build -t shykes/myapp:1.0.2 -t shykes/myapp:latest .

directive : In computer programming, a directive or pragma (from "pragmatic") is a language construct that specifies how a compiler (or other translator) should process its input. Directives are not part of the grammar of a programming language, and may vary from compiler to compiler. They can be processed by a preprocessor to specify compiler behavior, or function as a form of in-band parameterization.

Understand how CMD and ENTRYPOINT interact
Both CMD and ENTRYPOINT instructions define what command gets executed when running a container. There are few rules that describe their co-operation.

Dockerfile should specify at least one of CMD or ENTRYPOINT commands.

ENTRYPOINT should be defined when using the container as an executable.

CMD should be used as a way of defining default arguments for an ENTRYPOINT command or for executing an ad-hoc command in a container.

CMD will be overridden when running the container with alternative arguments.
apt-get install -y foo // to upgradee the last version of foo
